<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LabPIIF</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/laboratorio.css">
  </head>
  <body>
    <header>
      <div class="grupo-izquierdo">
        <img src="img/logoBM-Mblanco.png" alt="Banco de México" class="bml" />
        <img src="img/logo1.png" alt="Banco de Mexico" class="logo" />
      </div>
      <div class="usuario">
        <!-- ICONOS MÓVIL -->
        <div class="iconos-movil">
          <button onclick="irInicio()">
            <img src="img/home.png" alt="Inicio" class="homeButtom">
          </button>
          <button onclick="cerrarSesion()">
            <img src="img/exit.png" alt="Cerrar sesión">
          </button>
        </div>
        <!-- ICONOS DESKTOP -->
        <div class="botones-header desktop-only">
          <button class="icono-header" onclick="irInicio(event)">
            <img src="img/home.png" alt="Inicio" class="icono-img homeD">
          </button>
          <button class="icono-header cerrar" onclick="cerrarSesion(event)">
            <img src="img/exit.png" alt="Cerrar sesión" class="icono-img">
          </button>
        </div>
        <!-- INFORMACIÓN + FOTO -->
        <div class="usuario-main">
          <div class="info">
            <div class="nombre-usuario">Luis Antonio Hernández De La Luz</div>
            <div class="numero-usuario">B16847</div>
          </div>
          <img src="img/b16847.png" alt="Usuario" class="foto-usuario">
        </div>
      </div>
    </header>
    <div class="contenido">
      <!-- BOTÓN HAMBURGUESA -->
      <button class="btn-hamburguesa">☰</button>
      <!-- LAYOUT GENERAL -->
      <div class="layout">
        
        <!-- Fuentes del laboratorio -->
        <div class="panel-fuentes">
          
          <!-- Botones de fuentes -->
          <div class="tabs">
            <button class="tab active" data-tab="institucionales">Fuentes institucionales</button>
            <button class="tab" data-tab="locales">Fuentes locales</button>
          </div>
          
          <!-- Contenedor de contenido de tabs -->
          <div class="tab-contenido">
            
            <!-- Fuentes institucionales -->
            <div class="tab-panel active" id="institucionales">
              <button class="btn-agregar-fuente" id="agregarFuenteInstitucional">Agregar fuente institucional</button>  
              <input type="text" class="buscador" placeholder="Buscar fuentes institucionales...">
              
              <!-- Contenedor scrollable -->
              <div class="lista-fuentes-contenedor">
                <div class="lista-fuentes fuentesInstitucionales">
                  
                  <div class="fuente-item" identificador='1f8a667a-1e7b-430c-ab61-041ae06ac315'>
                      <img src="img/info.png" class="fuente-icono" alt="icono">
                      <span class="fuente-nombre">Operaciones de Préstamo. Costo promedio ponderado de préstamos concertados</span>
                      <div class="fuente-menu">
                          <button class="menu-btn">☰</button>
                          <div class="menu-opciones">
                              <button class="opcion usar">Usar</button>
                              <button class="opcion eliminar">Remover</button>
                          </div>
                      </div>
                  </div>

                  <div class="fuente-item" identificador='690f849d-c5c2-456e-80ca-126bad65084f'>
                      <img src="img/info.png" class="fuente-icono" alt="icono">
                      <span class="fuente-nombre">Operaciones de compra - venta. Volumen operado de títulos en moneda nacional y UDIS: por emisión y tipo de contraparte</span>
                      <div class="fuente-menu">
                          <button class="menu-btn">☰</button>
                          <div class="menu-opciones">
                              <button class="opcion usar">Usar</button>
                              <button class="opcion eliminar">Remover</button>
                          </div>
                      </div>
                  </div>

                  <div class="fuente-item" identificador='b995420c-a8b0-49ce-8f68-c62de7b95095'>
                      <img src="img/info.png" class="fuente-icono" alt="icono">
                      <span class="fuente-nombre">Operaciones de reporto: volumen, contrapartes, plazos, tasas, etc.</span>
                      <div class="fuente-menu">
                          <button class="menu-btn">☰</button>
                          <div class="menu-opciones">
                              <button class="opcion usar">Usar</button>
                              <button class="opcion eliminar">Remover</button>
                          </div>
                      </div>
                  </div>

                  

                  <!-- Resto de elementos .fuente-item iguales -->

                </div>
              </div>
              
            </div>
            
            <!-- Fuentes locales -->
            <div class="tab-panel" id="locales">
              <button class="btn-agregar-fuente" id="agregarFuenteLocal">Subir archivo</button>
              <input type="text" class="buscador" placeholder="Buscar archivos locales...">
              
              <div class="lista-fuentes-contenedor">
                <div class="lista-fuentes fuentesLocales">


                  <div class="fuente-item" archivo='contrapartes' extension='xlsx'>
                      <img src="img/document.png" class="fuente-icono" alt="icono">
                      <span class="fuente-nombre">Información de contrapartes</span>
                      <div class="fuente-menu">
                          <button class="menu-btn">☰</button>
                          <div class="menu-opciones">
                              <button class="opcion usarArchivo">Usar</button>
                              <button class="opcion eliminar">Remover</button>
                          </div>
                      </div>
                  </div>

                  <div class="fuente-item" archivo='rentaVar' extension='csv'>
                      <img src="img/document.png" class="fuente-icono" alt="icono">
                      <span class="fuente-nombre">Mercado de renta variable</span>
                      <div class="fuente-menu">
                          <button class="menu-btn">☰</button>
                          <div class="menu-opciones">
                              <button class="opcion usarArchivo">Usar</button>
                              <button class="opcion eliminar">Remover</button>
                          </div>
                      </div>
                  </div>

                </div>
              </div>
              
            </div>
          

          </div>
        
        </div>
        

       <section class="panel-notebook">
  <!-- PANEL FIJO DE BOTONES -->
  <div class="acciones-fijas">
    <button class="btn-accion btn-play-global" id="btnEjecutarGlobal" data-tooltip="Ejecutar">
        <img src="img/play.png" alt="Ejecutar">
    </button>
    <button class="btn-accion" id="btnAgregarTexto" data-tooltip="Agregar celda de texto">
        <img src="img/agregarCeldaTexto.png" alt="Agregar texto">
    </button>

    <button class="btn-accion" id="btnAgregarCodigo" data-tooltip="Agregar celda de código">
        <img src="img/agregarCeldaCodigo.png" alt="Agregar código">
    </button> 
    <button class="btn-accion btn-eliminar-global" data-tooltip="Eliminar celda">
        <img src="img/delete.png" alt="Agregar código">
    </button>

  </div>

  <!-- CONTENEDOR DEL NOTEBOOK CON SCROLL -->
  <div id="notebook-scroll">
    <!-- CELDA DE TEXTO -->
    <div class="celda">
      <p>Bienvenido al laboratorio de Python. Haz click aquí para seleccionarla.</p>
    </div>

    <!-- CELDA DE CÓDIGO -->
    <div class="celda celda-codigo" data-celda="1">
      <div class="editor" id="editor-1" style="height:150px;border:1px solid #ccc;border-radius:6px;"></div>
      <div class="resultado" style="display:none;">Suma: 12</div>
    </div>

    <!-- CELDA DE CÓDIGO -->
    <div class="celda celda-codigo" data-celda="2">
      <div class="editor" id="editor-2" style="height:150px;border:1px solid #ccc;border-radius:6px;"></div>
      <div class="resultado" style="display:none;">
        <img src="img/grafica.png" alt="Gráfica simulada" style="width:100%; max-width:400px; border:1px solid #ccc; border-radius:6px;">
      </div>
    </div>


    
    <!-- Puedes agregar más celdas aquí -->
  </div>
</section>



<!-- MODAL -->
<div id="modalFuentes" class="modal-overlay">
  <div class="modal-contenido">

      <h2>Seleccionar fuente institucional</h2>

      <div class="tabla-responsive">
        <table class="tabla-fuentes" id="tablaFuentes">
          <thead>
            <tr>
              <th>Nombre</th>
              <th>Descripción</th>
              <th>Acción</th>
            </tr>
          </thead>
          <tbody>
            <!-- Rellenado dinámicamente -->
          </tbody>
        </table>
      </div>

      <button class="modal-cerrar" id="cerrarModalFuentes">Cerrar</button>

  </div>
</div>

<!-- MODAL PARA SUBIR ARCHIVO -->
<div id="modalArchivo" class="modal-archivo oculto">
  <div class="modal-contenido">
    <h2>Agregar archivo local</h2>

    <label>Nombre del archivo:</label>
    <input type="text" id="nombreArchivoManual" placeholder="Ej: Información de contrapartes">

    <label>Seleccionar archivo:</label>
    <input type="file" id="archivoLocal">

    <div class="modal-acciones">
      <button id="btnCancelarArchivo" class="btn-cancelar">Cancelar</button>
      <button id="btnAgregarArchivo" class="btn-confirmar">Agregar archivo</button>
    </div>
  </div>
</div>








      </div>
    </div>
    <script src="js/laboratorio.js"></script>

    <!-- CSS de Quill -->
<link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet">

<!-- JS de Quill -->
<script src="https://cdn.quilljs.com/1.3.7/quill.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.41.0/min/vs/loader.js"></script>
<script>
  require.config({ paths: { vs: 'https://cdn.jsdelivr.net/npm/monaco-editor@0.41.0/min/vs' }});
  require(['vs/editor/editor.main'], function() {
    const celdasCodigo = document.querySelectorAll('.celda-codigo .editor');
    const editores = [];

    const editor1 = monaco.editor.create(document.getElementById('editor-1'), {
    value: `# Código por default: suma de 2 números
x = 5
y = 7
print(f"Suma: {x + y})`,
    language: 'python',
    theme: 'vs-light',
    automaticLayout: true,
    minimap: { enabled: false }
  });

    const editor2 = monaco.editor.create(document.getElementById('editor-2'), {
    value: `# Gráfica de ejemplo
x = [1,2,3,4]
y = [10,20,15,30]
plt.plot(x,y)
plt.show()
`,
    language: 'python',
    theme: 'vs-light',
    automaticLayout: true,
    minimap: { enabled: false }
  });



    const btnPlayGlobal = document.querySelector('.btn-play-global');
    let celdaActivaIndex = 0;

    document.querySelectorAll('.celda').forEach((celda, i) => {
      celda.addEventListener('click', () => {
        celdaActivaIndex = i;
        document.querySelectorAll('.celda').forEach(c => c.classList.remove('activa'));
        celda.classList.add('activa');
      });
    });

    
  });
</script>




  </body>
</html>
